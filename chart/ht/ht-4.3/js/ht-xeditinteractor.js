!function(U,Z,j){"use strict";var I="ht",S=U[I],J=S.Default,p=S.graph,K=J.getInternal(),b=K.ui(),Y=b.NodeUI.prototype,l=b.ShapeUI.prototype,_=p.GraphView,H=_.prototype,c=b.EdgeUI.prototype,C=S.Node,O=S.Shape,E=S.Edge,m=S.Group,g=J.isTouchable,P=J.preventDefault,G=U.setTimeout,d=J.grow,t=J.isDragging,Q=J.getDistance,w=null,i=S.List,B="undefined"!=typeof Float32Array?Float32Array:Array,u=Math,N=u.PI,n="Crossing",v="No Crossing",W=N/2,r=2*N,x=u.atan2,e=u.sqrt,o=u.pow,L=u.sin,A=u.cos,y=u.min,s=u.max,M=u.abs,a=u.ceil,f=u.round,R=J.unionPoint,F=J.unionRect,T=J.containsPoint,z=J.clone,h="rgb(52, 152, 219)",D="red",V={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},q={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var B=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],J=0;J<B.length;J++){var r=B[J];r=0===J%2?r/400*q.width:r/100*q.height,B[J]=r}return q.width>120&&(B[4]=q.width-26,B[6]=q.width-40,B[10]=q.width-40,B[12]=q.width-26,B[18]=33),B}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},X={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:h,rotation:.61},{type:"circle",rect:[200,120,70,70],background:h,rotation:.61},{type:"circle",rect:[200,220,70,70],background:h,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:h},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:h}]},k={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:D,rotation:.61}]},$={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:h},{type:"circle",rect:[0,210,90,90],background:h},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:h}]},He={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:D},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:D}]},Lc={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:h}]},Oi={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:D}]},id={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},wf={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},ji=function(J){var l=J.touches[0];return l?l:J.changedTouches[0]},Ib=function(V,o,T,H){return x(H-o,T-V)},Vk=function(R,g){return{x:R.x*g,y:R.y*g}},Hn=function(s,c){var O,E,r,y,L=s._layers,Z=s.sm().getSelection()._as,A=Z.length;if(L)for(O=0;O<L.length;O++){y=L[O];for(var M=0;A>M;M++)if(E=Z[M],E._layer===y&&(r=c(E),r===!1))return}else for(O=0;A>O;O++)if(E=Z[O],r=c(E),r===!1)return},$q=function(s,H,R){var D,U,j,Q,N,e=this,b=H,l=e.gv;if(s instanceof O){j=s.getSegments();var d=l.getDataUI(s);N=d._55O.$15l,j||(j=ol(N)),s.isClosePath()&&j.indexOf(5)<0&&(j=new i(j._as),j.add(5)),D=ah(s,d,b),U=N[D]}else{var E=l.getDataUI(s);N=Gf(E,s.s("edge.points")),j=s.s("edge.segments"),j||(j=ol(N)),N=N._as,D=ah(s,E,b),U=N[D]}if(j&&(Q=j.get(b)),2===Q||1===Q||5===Q){var L=N[D+1];5===Q&&(L=N[0]);var x=Rq(U,R,L);return x}return R},jg=function(g,A){var u,b,F,n,f=g._layers,C=g.sm().getSelection()._as,J=C.length;if(f)for(u=f.length-1;u>=0;u--){n=f[u];for(var c=J-1;c>=0;c--)if(b=C[c],b._layer===n&&(F=A(b),F===!1))return}else for(u=J-1;u>=0;u--)if(b=C[u],F=A(b),F===!1)return},od=function(A,K,Q,z){var m=K/2,L=Q/2,l=fg(A,-m,-L,z),C=fg(A,m,-L,z),J=fg(A,-m,L,z),G=fg(A,m,L,z),M=fg(A,0,-L,z),b=fg(A,m,0,z),g=fg(A,0,L,z),x=fg(A,-m,0,z);return[l,C,J,G,M,b,g,x]},Rq=function(u,K,c){var S={x:K.x-u.x,y:K.y-u.y},F={x:c.x-u.x,y:c.y-u.y},y=e(o(c.x-u.x,2)+o(c.y-u.y,2)),v={x:F.x/y,y:F.y/y},k=S.x*v.x+S.y*v.y,L={x:v.x*k,y:v.y*k};return{x:u.x+L.x,y:u.y+L.y}},fg=function(q,x,P,T){var j=A(T)*x-L(T)*P,N=L(T)*x+A(T)*P;return q?{x:q.x+j,y:q.y+N}:{x:j,y:N}},Zk=function(L,Y){return Y>2*L?L:Y/2},lq=function(M,h,b,g){var Z=Q(M,h);return b=g?y(b,Z):Zk(b,Z),Z?b/=Z:b=0,{x:M.x+(h.x-M.x)*b,y:M.y+(h.y-M.y)*b}},ab=function(H,I,Z,G,x){return I?(Z=K.getPosition(Z,K.getNodeRect(H,I)),Z.x+=G||0,Z.y+=x||0,Z):w},er=function(c,M){var p,o,L=c.gv,N=c._data,K=N._40I,n=N._41I,e=N.s("edge.offset"),k=N.s("edge.source.position"),R=N.s("edge.target.position"),x=N.s("edge.source.offset.x"),d=N.s("edge.source.offset.y"),$=N.s("edge.target.offset.x"),J=N.s("edge.target.offset.y");if(M?(p=ab(L,K,k,x,d),o=ab(L,n,R,$,J)):(p=ab(L,K,k),o=ab(L,n,R)),"points"===N.s("edge.type")&&e&&!N.s("edge.center")&&p){var y=N.s("edge.points")||new i,G=y.size(),f=lq(p,G?y.get(0):o,e,G),m=lq(o,G?y.get(G-1):p,e,G);p=f,o=m}return[p,o]},Gf=function(R,v,A){var b=R._78o,d=R._data,S=d.s("edge.type"),x=[b._69o,b._70o];return"points"===S?A&&(x=er(R)):x=b.center?S?A?er(R):er(R,!0):A?er(R):[b.c1,b.c2]:A?er(R):er(R,!0),v=new i(v?v._as:w),v.add(x[0],0),v.add(x[1]),v},Og=function(v){return v=new i(v._as),v.removeAt(0),v.removeAt(v.size()-1),v},ol=function(e){e._as||(e=new i(e));var J=new i;J.add(1);for(var N=1;N<e.size();N++)J.add(2);return J},Mf=function(l,T){return{x:(l.x+T.x)/2,y:(l.y+T.y)/2}},Rn=function(N,Y){return{x:N.x+1*(Y.x-N.x)/4,y:N.y+1*(Y.y-N.y)/4}},zc=function(i,L){return{x:i.x+3*(L.x-i.x)/4,y:i.y+3*(L.y-i.y)/4}},Wc=function(G,f,m,n){var P=f.x+f.width/2,R=f.y+f.height/2,O=e(P*P+R*R),H=x(R,P)+m;return{x:n.x+O*A(H),y:n.y+O*L(H)}},zg=H.validateImpl,Bj=H.isRectEditable,bq=H.isPointEditable,Eh=H._42,Fh=l._79o,np=c._79o,rc=l._48O,Ue=l._47O,ap=Y._48O,Tn=Y._80o,Pb=l._80o,gs=Y._2o,sq=Y._47O,eg=c._47O,Pf=H.isEditable,Rl=["northwest","north","northeast","east","southeast","south","southwest","west"],Xc=function(Y,i,Q,B,M,C,A,J,c,V){var a=Y.x,f=Y.y,U=Y.width,K=Y.height,j={x:a+U/2,y:f+K/2};B=B||0,i=fg(j,i.x-j.x,i.y-j.y,-B),A&&!J&&(i.x+=c,i.y+=V);var H=.01;if("northwest"===Q?(i.x+M>a+U-H&&(i.x=a+U-M-H),i.y+M>f+K-H&&(i.y=f+K-M-H),Y=R(i,{x:a+U,y:f+K})):"north"===Q?(i.y+M>f+K-H&&(i.y=f+K-M-H),Y=R({x:a,y:i.y},{x:a+U,y:f+K})):"northeast"===Q?(i.x<a+M+H&&(i.x=a+M+H),i.y+M>f+K-H&&(i.y=f+K-M-H),Y=R({x:a,y:i.y},{x:i.x,y:f+K})):"west"===Q?(i.x+M>a+U-H&&(i.x=a+U-M-H),Y=R({x:i.x,y:f},{x:a+U,y:f+K})):"east"===Q?(i.x<a+M+H&&(i.x=a+M+H),Y=R({x:a,y:f},{x:i.x,y:f+K})):"southwest"===Q?(i.x+M>a+U-H&&(i.x=a+U-M-H),i.y<f+M+H&&(i.y=f+M+H),Y=R({x:i.x,y:f},{x:a+U,y:i.y})):"south"===Q?(i.y<f+M+H&&(i.y=f+M+H),Y=R({x:a,y:f},{x:a+U,y:i.y})):"southeast"===Q&&(i.x<a+M+H&&(i.x=a+M+H),i.y<f+M+H&&(i.y=f+M+H),Y=R({x:a,y:f},i)),"keepRatio"===C&&(!A&&J||A&&!J)&&("northeast"===Q||"southeast"===Q||"northwest"===Q||"southwest"===Q)){var o=Y.width,O=Y.height,n=o/U,$=O/K,L=y(n,$);Y.width=U*L,Y.height=K*L,"northeast"===Q?Y.y=f+(K-Y.height):"northwest"===Q?(Y.y=f+(K-Y.height),Y.x=a+(U-Y.width)):"southwest"===Q&&(Y.x=a+(U-Y.width))}Y.x-=j.x,Y.y-=j.y;var D=Wc(w,Y,B,j);return Y.x=D.x-Y.width/2,Y.y=D.y-Y.height/2,Y},Tc=function(Q,d,Z,W){var g=Q.getRotation(),O=d,w=O.x,v=O.y,J=O.width,n=O.height,I={x:w+O.width/2,y:v+O.height/2};W=fg(I,W.x-I.x,W.y-I.y,-g),"northwest"===Z?O=R(W,{x:w+J,y:v+n}):"north"===Z?O=R({x:w,y:W.y},{x:w+J,y:v+n}):"northeast"===Z?O=R({x:w,y:W.y},{x:W.x,y:v+n}):"west"===Z?O=R({x:W.x,y:v},{x:w+J,y:v+n}):"east"===Z?O=R({x:w,y:v},{x:W.x,y:v+n}):"southwest"===Z?O=R({x:W.x,y:v},{x:w+J,y:W.y}):"south"===Z?O=R({x:w,y:v},{x:w+J,y:W.y}):"southeast"===Z&&(O=R({x:w,y:v},W)),Q.setRect(O),O.x-=I.x,O.y-=I.y;var Y=Wc(Q,O,g,I);Q.p(Y.x,Y.y)},wn=function(j,S,d,u,U,G,P,Z){var R=w;G?(R=fg(w,U.x-S.x,U.y-S.y,-d),R.x-=P.x,R.y-=P.y):R=fg(w,U.x-S.x,U.y-S.y,0);var x={x:S.x+R.x,y:S.y+R.y};Z&&(x=Z(x.x,x.y)),x.e=j.getPoints().get(u).e,j.setPoint(u,x);var e=j.getWidth(),a=j.getHeight(),Q=j.p().x-e/2,i=j.p().y-a/2;Q-=S.x,i-=S.y;var z=Wc(j,{x:Q,y:i,width:e,height:a},d,S);j.p(z.x,z.y)},ah=function(W,f,M){var y,x;if(W instanceof O?(y=W.getPoints(),x=W.getSegments()):W instanceof E&&"points"===W.s("edge.type")&&(y=W.s("edge.points"),x=W.s("edge.segments"),y=Gf(f,y)),x||(x=ol(y)),W instanceof O&&W.isClosePath()&&x.indexOf(5)<0&&(x=new i(x._as),x.add(5)),x)for(var A=-1,Z=0;Z<x.size();Z++){if(Z===M)return A;var Y=x.get(Z);1===Y?A+=1:2===Y?A+=1:3===Y?A+=2:4===Y&&(A+=3)}},Ul=function(b,F,j){var P,Q;if(b instanceof O?(P=b.getPoints(),Q=b.getSegments()):b instanceof E&&"points"===b.s("edge.type")&&(P=b.s("edge.points"),Q=b.s("edge.segments"),P=Gf(F,P)),Q||(Q=ol(P)),Q)for(var B=-1,g=0;g<Q.size();g++){var I=Q.get(g);if(1===I?B+=1:2===I?B+=1:3===I?B+=2:4===I&&(B+=3),B===j)return g}},Cd=function(Z,z){var i=[Z[0]-z[0],Z[1]-z[1],Z[2]-z[2]];return i},aj=function(){var r=new B(16);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},Cp=function(D,y){var A=D[0],g=D[1],T=D[2];return D[0]=y[0]*A+y[4]*g+y[8]*T+y[12],D[1]=y[1]*A+y[5]*g+y[9]*T+y[13],D[2]=y[2]*A+y[6]*g+y[10]*T+y[14],D},ts=function(H,a){if(a){var Z=L(a),k=A(a),F=H[0],Q=H[1],K=H[2],t=H[3],T=H[8],l=H[9],I=H[10],O=H[11];H[0]=F*k-T*Z,H[1]=Q*k-l*Z,H[2]=K*k-I*Z,H[3]=t*k-O*Z,H[8]=F*Z+T*k,H[9]=Q*Z+l*k,H[10]=K*Z+I*k,H[11]=t*Z+O*k}},Xj=function(B,Q){for(var y=B.s("grid.row.count"),m=B.s("grid.column.count"),o=0;y>o;o++)for(var t=0;m>t;t++){var u=B.getCellRect(o,t);if(T(u,Q))return{rowIndex:o,columnIndex:t,rect:u,grid:B}}return null},be=function(N,$,n,j,M,r){var h={},C=n-N,J=j-$,q=u.sqrt(C*C+J*J),E=C/q,Q=J/q,f=(-N+M)*E+(-$+r)*Q;return 0>=f?(h.x=N,h.y=$):f>=q?(h.x=n,h.y=j):(h.x=N+f*E,h.y=$+f*Q),C=M-h.x,J=r-h.y,h.z=u.sqrt(C*C+J*J),h},fl=function(z,C){var I,e,o,D,J,g,t,Y,x=z.getPoints(),S=z.getSegments(),c=z.p(),V=z.getRotation();if(!S||!(S.indexOf(3)>0||S.indexOf(4)>0)){for(Y=0;Y<=x.size()-1;Y++)if(Y===x.size()-1?(J=x.get(0),D=x.get(Y)):(D=x.get(Y),J=x.get(Y+1)),D=fg(c,D.x-c.x,D.y-c.y,V),J=fg(c,J.x-c.x,J.y-c.y,V),g=be(D.x,D.y,J.x,J.y,C.x,C.y),t=g.z,t<(z.s("shape.border.width")||10)){e=D,o=J,I=Y;break}if(I!=w){var W=be(e.x,e.y,o.x,o.y,C.x,C.y),f=Q(e,W);return{attachIndex:I,attachOffset:f}}}},Ti=function(x){for(var O=x._data,h=O.p(),_=O.getRotation(),l=O.getPoints(),J=w,o=[],T=0;T<l.size();T++)J=l.get(T),o.push(fg(h,J.x-h.x,J.y-h.y,_));x._55O.$15l=o};H._editPointSize=g?24:9,H._edgeHelpers=["parent","remove","source","target"],H._leftTopHelpers=["parent"],H._rightTopHelpers=["host"],H._leftBottomHelpers=["edge"],H._rightBottomHelpers=["remove"],Rl=Rl.concat(Rl).concat(Rl),c._79o=function(){var t=this,l=t.gv,I=l.getZoom(),J=l._editInteractor,n=np.call(t),X=er(t,!0),L=X[0],q=X[1],c={x:n.x,y:n.y,width:n.width,height:n.height},M=R(L,q);if(J instanceof p.XEditInteractor){c=F(c,M);var Z=t._55O,A=l.getEditPointSize()/I+2,U=0;Z&&Z._43O&&(U+=A/2,d(c,U))}return c},c._47O=function(w){var k=this,M=k.gv,D=M._editInteractor;D instanceof p.XEditInteractor||eg.call(k,w)},c.rectIntersects=function(G){var R=this,t=R._data,l=R.gv,Z=l.getZoom(),i=R._55O,C=l._editInteractor;if(C instanceof p.XEditInteractor&&l.isEditable(t)&&i&&i._43O&&"points"===t.s("edge.type")){var B=t.s("edge.points"),V=t.s("edge.segments");B=Gf(R,B),V||(V=ol(B)),B=B._as;var K=!1,r=g?5:1,A=G.x+r,y=G.y+r,x={x:A,y:y};if(C._edge===t&&C._hoverSegmentIndex>=0){var F=l._editInteractor._hoverSegmentIndex,b=V.get(F),L=ah(t,R,F),O=w;if(L!=w&&L>=0){var S=B[L],h=l.getSegmentHoverWidth()/Z;if(2===b||1===b){var J=B[L+1];O=Ob(new oo(S.x,S.y),new oo(J.x,J.y),new oo(x.x-h,x.y-h),new oo(x.x+2*h,x.y+2*h)),O.$62l===n&&(K=!0)}else if(3===b){var N=B[L+1],J=B[L+2];O=ph(new oo(S.x,S.y),new oo(N.x,N.y),new oo(J.x,J.y),new oo(x.x-h,x.y-h),new oo(x.x+2*h,x.y+2*h)),O.$62l===n&&(K=!0)}else if(4===b){var c=B[L+1],d=B[L+2];J=B[L+3],O=Uc(new oo(S.x,S.y),new oo(c.x,c.y),new oo(d.x,d.y),new oo(J.x,J.y),new oo(x.x-h,x.y-h),new oo(x.x+2*h,x.y+2*h)),O.$62l===n&&(K=!0)}}}if(K)return!0}return w},l._47O=function(m){var E=this,l=E.gv,c=l._editInteractor;c instanceof p.XEditInteractor||Ue.call(E,m)},l.rectIntersects=function(v){var u=this,L=u._data,K=u.gv,O=K.getZoom(),Y=u._55O,c=K._editInteractor;if(c instanceof p.XEditInteractor&&K.isEditable(L)&&Y&&Y._43O){var f=Y.$15l,M=!1,Q=g?5:1,I=v.x+Q,m=v.y+Q,l={x:I,y:m};if(f&&f.length===L.getPoints().size()||(Ti(u),f=Y.$15l),c._shape===L&&c._hoverSegmentIndex>=0){var x=L.getSegments();x||(x=ol(f));var J=K._editInteractor._hoverSegmentIndex,U=x.get(J),$=ah(L,u,J),F=w;if($!=w&&$>=0){var N=f[$],a=K.getSegmentHoverWidth()/O;if(2===U||1===U){var G=f[$+1];F=Ob(new oo(N.x,N.y),new oo(G.x,G.y),new oo(l.x-a,l.y-a),new oo(l.x+2*a,l.y+2*a)),F.$62l===n&&(M=!0)}else if(3===U){var k=f[$+1],G=f[$+2];F=ph(new oo(N.x,N.y),new oo(k.x,k.y),new oo(G.x,G.y),new oo(l.x-a,l.y-a),new oo(l.x+2*a,l.y+2*a)),F.$62l===n&&(M=!0)}else if(4===U){var S=f[$+1],H=f[$+2];G=f[$+3],F=Uc(new oo(N.x,N.y),new oo(S.x,S.y),new oo(H.x,H.y),new oo(G.x,G.y),new oo(l.x-a,l.y-a),new oo(l.x+2*a,l.y+2*a)),F.$62l===n&&(M=!0)}}}if(M)return!0}return w},l._48O=function(){var y=this,V=y.gv,a=V._editInteractor;a instanceof p.XEditInteractor?(Y._48O.call(y),y._55O._43O&&Ti(y)):rc.call(y)},l._79o=function(){var c=this,h=c.gv,Q=h.getZoom(),k=h._editInteractor,H=Fh.call(c);if(H){var o={x:H.x,y:H.y,width:H.width,height:H.height};if(k instanceof p.XEditInteractor){var P=c._55O,T=h.getEditPointSize()/Q+2,J=0;P&&P._43O&&(J+=T/2,d(o,J))}return o}},Y._47O=function(r){var F=this,z=F.gv,x=z._editInteractor;if(x instanceof p.XEditInteractor);else{var P=F._55O;P&&P._98o&&sq.call(F,r)}},Y._2o=function(){var Q=this,e=Q.gv,B=e._editInteractor,C=Q._data;return e.isEditable(C)&&B instanceof p.XEditInteractor?0:gs.call(Q)},Y._80o=function(E){var T=this,H=T.gv._editInteractor;if(Tn.call(T,E),H&&H._debug){E.save(),E.beginPath(),E.lineWidth=1,E.strokeStyle="green";var o=T._79o();o&&(E.rect(o.x,o.y,o.width,o.height),E.stroke()),E.restore()}},l._80o=function(S){var K=this,E=K.gv._editInteractor;if(Pb.call(K,S),E&&E._debug){S.save(),S.beginPath(),S.lineWidth=1,S.strokeStyle="green";var T=K._79o();S.rect(T.x,T.y,T.width,T.height),S.stroke(),S.restore()}},Y._48O=function(){var m=this,R=m.gv,g=m._data,Z=R._editInteractor,$=m._55O,D=g.p(),t=g.getRotation();if(Z instanceof p.XEditInteractor){if($._42O){var b=od(D,g.getWidth(),g.getHeight(),t),v=b[0],k=b[1],Q=b[2],q=b[3],P=b[4],A=b[5],J=b[6],f=b[7];$.$45l=[v,P,k,A,q,J,Q,f]}}else ap.call(m)},H.getResizeMode=function(){return this.$25l||"normal"},H.setResizeMode=function(g){var J=this.$25l;this.$25l=g,this.fp("resizeMode",J,g)},H.getSnapAngle=function(){return this.$26l||Math.PI/36},H.setSnapAngle=function(v){var o=this.$26l;this.$26l=v,this.fp("snapAngle",o,v)},H.getSnapSpacing=function(){return this.$27l},H.setSnapSpacing=function(m){var I=this.$27l;this.$27l=m,this.fp("snapSpacing",I,m)},H.getPointSnapSpacing=function(){return this._pointSnapSpacing},H.setPointSnapSpacing=function(P){var l=this._pointSnapSpacing;this._pointSnapSpacing=P,this.fp("pointSnapSpacing",l,P)},H.setHelperEditableFunc=function(S){var U=this._helperEditableFunc;this._helperEditableFunc=S,this.fp("helperEditableFunc",U,S)},H.getHelperEditableFunc=function(){return this._helperEditableFunc},H.setLeftTopHelpers=function(x){var r=this._leftTopHelpers;this._leftTopHelpers=x,this.fp("leftTopHelpers",r,x)},H.getLeftTopHelpers=function(){return this._leftTopHelpers},H.setLeftTopHelpersAlign=function(G){var Y=this._leftTopHelpersAlign;this._leftTopHelpersAlign=G,this.fp("leftTopHelpersAlign",Y,G)},H.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},H.setRightTopHelpers=function($){var k=this._rightTopHelpers;this._rightTopHelpers=$,this.fp("rightTopHelpers",k,$)},H.getRightTopHelpers=function(){return this._rightTopHelpers},H.setRightTopHelpersAlign=function(g){var b=this._rightTopHelpersAlign;this._rightTopHelpersAlign=g,this.fp("rightTopHelpersAlign",b,g)},H.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},H.setLeftBottomHelpers=function(R){var w=this._leftBottomHelpers;this._leftBottomHelpers=R,this.fp("leftBottomHelpers",w,R)},H.getLeftBottomHelpers=function(){return this._leftBottomHelpers},H.setLeftBottomHelpersAlign=function(e){var y=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=e,this.fp("leftBottomHelpersAlign",y,e)},H.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},H.setRightBottomHelpers=function(N){var o=this._rightBottomHelpers;this._rightBottomHelpers=N,this.fp("rightBottomHelpers",o,N)},H.getRightBottomHelpers=function(){return this._rightBottomHelpers},H.setRightBottomHelpersAlign=function(b){var c=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=b,this.fp("rightBottomHelpersAlign",c,b)},H.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},H.setEdgeHelpers=function(c){var Q=this._edgeHelpers;this._edgeHelpers=c,this.fp("edgeHelpers",Q,c)},H.getEdgeHelpers=function(){return this._edgeHelpers},H.isHelperEditable=function(f,i){return f instanceof E&&("host"===i||"edge"===i||"elevation"===i||"tall"===i)?!1:f instanceof C&&("source"===i||"target"===i)?!1:"pointElevation"===i?this._helperEditableFunc?this._helperEditableFunc(f,i):!1:this._helperEditableFunc?this._helperEditableFunc(f,i):!0},H.getEditHelperSize=function(){return this._editHelperSize||(g?28:16)},H.setEditHelperSize=function(p){var X=this._editHelperSize;this._editHelperSize=p,this.fp("editHelperSize",X,p)},H.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},H.setEditRectBorderColor=function(i){var v=this.$28l;this.$28l=i,this.fp("editRectBorderColor",v,i)},H.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},H.setNodeBorderColor=function(M){var E=this.$29l;this.$29l=M,this.fp("nodeBorderColor",E,M)},H.getEditRectBorderStyle=function(){return this.$30l||"dashed"},H.setEditRectBorderStyle=function(l){var T=this.$30l;this.$30l=l,this.fp("editRectBorderStyle",T,l)},H.getControlPointBackground=function(){return this.$31l||"#ff0"},H.setControlPointBackground=function(z){var p=this.$31l;this.$31l=z,this.fp("controlPointBackground",p,z)},H.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},H.setControlPointBorderColor=function(O){var w=this.$32l;this.$32l=O,this.fp("controlPointBorderColor",w,O)},H.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},H.setJoinPointBackground=function(x){var _=this.$33l;this.$33l=x,this.fp("joinPointBackground",_,x)},H.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},H.setJoinPointBorderColor=function(I){var m=this.$34l;this.$34l=I,this.fp("joinPointBorderColor",m,I)},H.getDirectionLineColor=function(){return this.$35l||"#888"},H.setDirectionLineColor=function(p){var F=this.$35l;this.$35l=p,this.fp("directionLineColor",F,p)},H.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},H.setSegmentHoverColor=function(E){var J=this.$36l;this.$36l=E,this.fp("segmentHoverColor",J,E)},H.getSegmentHoverWidth=function(){return this.$22l||(g?16:8)},H.setSegmentHoverWidth=function(E){var G=this.$22l;this.$22l=E,this.fp("segmentHoverWidth",G,E)},H.getSnapPointBorderColor=function(){return this.$38l||"#f00"},H.setSnapPointBorderColor=function(u){var I=this.$38l;this.$38l=u,this.fp("snapPointBorderColor",I,u)},H.getEditRectPadding=function(){return this.$39l!=w?this.$39l:6},H.setEditRectPadding=function(Y){var d=this.$39l;this.$39l=Y,this.fp("editRectPading",d,Y)},H.isRectEditable=function(F){var $=this,N=$._editInteractor;return N instanceof p.XEditInteractor?$._rectEditableFunc?$._rectEditableFunc(F):!0:Bj.call($,F)},H.isPointEditable=function(z){var d=this,E=d._editInteractor;return E instanceof p.XEditInteractor?d._pointEditableFunc?d._pointEditableFunc(z):!0:bq.call(d,z)},H.validateImpl=function(){var $=this,S=$.$14l,M=$._editInteractor;if(S){var A=$.getWidth(),R=$.getHeight();(A!==S.clientWidth||R!==S.clientHeight)&&(M&&(M._68I=1),K.setCanvas(S,A,R),$._32I=1)}zg.call(this)},H.isEditable=function(j){var c=Pf.call(this,j),B=this._editInteractor;if(B instanceof p.XEditInteractor&&j instanceof E){j.getSource()==j.getTarget()&&(c=!1);var Y=this.getEditableFunc();c=Y?Y(j):!0}return c},H._42=function(a,f){var O=this,W=O._editInteractor;Eh.call(O,a,f),W instanceof p.XEditInteractor&&W._68I&&W._42()},H.isSnapPoint=function(){return!0};var xn=function(k){arguments.length>0&&this.$58l(k)},Tp=xn.prototype;Tp.$58l=function(V){this.$62l=V,this.points=new Array},Tp.$56l=function(d){this.points.push(d)},Tp.$57l=function(p){this.points=this.points.concat(p)};var oo=function(O,T){arguments.length>0&&this.$58l(O,T)},Kn=oo.prototype;Kn.$58l=function(e,b){this.x=e,this.y=b},Kn.add=function(E){return new oo(this.x+E.x,this.y+E.y)},Kn.addEquals=function($){return this.x+=$.x,this.y+=$.y,this},Kn.$55l=function(p){return new oo(this.x*p,this.y*p)},Kn.eq=function(U){return this.x==U.x&&this.y==U.y},Kn.lt=function(Z){return this.x<Z.x&&this.y<Z.y},Kn.lte=function(Z){return this.x<=Z.x&&this.y<=Z.y},Kn.gt=function(d){return this.x>d.x&&this.y>d.y},Kn.gte=function(N){return this.x>=N.x&&this.y>=N.y},Kn.lerp=function(T,s){return new oo(this.x+(T.x-this.x)*s,this.y+(T.y-this.y)*s)},Kn.distanceFrom=function(w){var f=this.x-w.x,m=this.y-w.y;return e(f*f+m*m)},Kn.min=function(H){return new oo(y(this.x,H.x),y(this.y,H.y))},Kn.max=function(r){return new oo(s(this.x,r.x),s(this.y,r.y))},Kn.toString=function(){return this.x+","+this.y};var Zl=function(){this.$58l(arguments)},Xo=Zl.prototype;Zl.TO=1e-6,Zl.AC=6,Xo.$58l=function(z){this.co=new Array;for(var E=z.length-1;E>=0;E--)this.co.push(z[E])},Xo.$55l=function(C){for(var g=new Zl,I=0;I<=this.$50l()+C.$50l();I++)g.co.push(0);for(var I=0;I<=this.$50l();I++)for(var w=0;w<=C.$50l();w++)g.co[I+w]+=this.co[I]*C.co[w];return g},Xo.$59l=function(){for(var T=this.$50l();T>=0&&M(this.co[T])<=Zl.TO;T--)this.co.pop()},Xo.$50l=function(){return this.co.length-1},Xo.$51l=function(){var p;switch(this.$59l(),this.$50l()){case 0:p=new Array;break;case 1:p=this.$52l();break;case 2:p=this.$53l();break;case 3:p=this.$54l();break;case 4:p=this.$63l();break;default:p=new Array}return p},Xo.$52l=function(){var X=new Array,o=this.co[1];return 0!=o&&X.push(-this.co[0]/o),X},Xo.$53l=function(){var Q=new Array;if(2==this.$50l()){var g=this.co[2],K=this.co[1]/g,C=this.co[0]/g,q=K*K-4*C;if(q>0){var z=e(q);Q.push(.5*(-K+z)),Q.push(.5*(-K-z))}else 0==q&&Q.push(.5*-K)}return Q},Xo.$63l=function(){var U=new Array;if(4==this.$50l()){var F=this.co[4],o=this.co[3]/F,J=this.co[2]/F,D=this.co[1]/F,_=this.co[0]/F,N=new Zl(1,-J,o*D-4*_,-o*o*_+4*J*_-D*D).$54l(),a=N[0],x=o*o/4-J+a;if(M(x)<=Zl.TO&&(x=0),x>0){var P=e(x),l=3*o*o/4-P*P-2*J,i=(4*o*J-8*D-o*o*o)/(4*P),y=l+i,z=l-i;if(M(y)<=Zl.TO&&(y=0),M(z)<=Zl.TO&&(z=0),y>=0){var c=e(y);U.push(-o/4+(P+c)/2),U.push(-o/4+(P-c)/2)}if(z>=0){var c=e(z);U.push(-o/4+(c-P)/2),U.push(-o/4-(c+P)/2)}}else if(0>x);else{var i=a*a-4*_;if(i>=-Zl.TO){if(0>i&&(i=0),i=2*e(i),l=3*o*o/4-2*J,l+i>=Zl.TO){var n=e(l+i);U.push(-o/4+n/2),U.push(-o/4-n/2)}if(l-i>=Zl.TO){var n=e(l-i);U.push(-o/4+n/2),U.push(-o/4-n/2)}}}}return U},Xo.$54l=function(){var s=new Array;if(3==this.$50l()){var $=this.co[3],g=this.co[2]/$,m=this.co[1]/$,F=this.co[0]/$,K=(3*m-g*g)/3,R=(2*g*g*g-9*m*g+27*F)/27,u=g/3,T=R*R/4+K*K*K/27,c=R/2;if(M(T)<=Zl.TO&&(T=0),T>0){var W,y,_=e(T);W=-c+_,y=W>=0?o(W,1/3):-o(-W,1/3),W=-c-_,W>=0?y+=o(W,1/3):y-=o(-W,1/3),s.push(y-u)}else if(0>T){var h=e(-K/3),G=x(e(-T),-c)/3,Y=A(G),I=L(G),v=e(3);s.push(2*h*Y-u),s.push(-h*(Y+v*I)-u),s.push(-h*(Y-v*I)-u)}else{var W;W=c>=0?-o(c,1/3):o(-c,1/3),s.push(2*W-u),s.push(-W-u)}}return s};var po=function(j,U){arguments.length>0&&this.$58l(j,U)},cd=po.prototype;cd.$58l=function(e,z){this.x=e,this.y=z},cd.length=function(){return e(this.x*this.x+this.y*this.y)},cd.$60l=function(H){return this.x*H.x+this.y*H.y};var mh=function(D,y,i,R){var z,e=(R.x-i.x)*(D.y-i.y)-(R.y-i.y)*(D.x-i.x),V=(y.x-D.x)*(D.y-i.y)-(y.y-D.y)*(D.x-i.x),F=(R.y-i.y)*(y.x-D.x)-(R.x-i.x)*(y.y-D.y);if(0!=F){var C=e/F,m=V/F;C>=0&&1>=C&&m>=0&&1>=m?(z=new xn(n),z.points.push(new oo(D.x+C*(y.x-D.x),D.y+C*(y.y-D.y)))):z=new xn(v)}else z=0==e||0==V?new xn("C"):new xn("P");return z},Rf=function(L,l,N,R,S){var W,K,Q,_,r,Z,p,A=R.min(S),P=R.max(S),d=new xn(v);W=l.$55l(-2),Q=L.add(W.add(N)),W=L.$55l(-2),K=l.$55l(2),_=W.add(K),r=new oo(L.x,L.y),p=new po(R.y-S.y,S.x-R.x),Z=R.x*S.y-S.x*R.y;for(var i=new Zl(p.$60l(Q),p.$60l(_),p.$60l(r)+Z).$51l(),X=0;X<i.length;X++){var C=i[X];if(C>=0&&1>=C){var M=L.lerp(l,C),x=l.lerp(N,C),g=M.lerp(x,C);R.x==S.x?A.y<=g.y&&g.y<=P.y&&(d.$62l=n,d.$56l(g)):R.y==S.y?A.x<=g.x&&g.x<=P.x&&(d.$62l=n,d.$56l(g)):g.gte(A)&&g.lte(P)&&(d.$62l=n,d.$56l(g))}}return d},ph=function(_,K,X,a,O){var C=a.min(O),M=a.max(O),s=new oo(M.x,C.y),f=new oo(C.x,M.y),i=Rf(_,K,X,C,s),z=Rf(_,K,X,s,M),t=Rf(_,K,X,M,f),G=Rf(_,K,X,f,C),e=new xn(v);return e.$57l(i.points),e.$57l(z.points),e.$57l(t.points),e.$57l(G.points),e.points.length>0&&(e.$62l=n),e},Mr=function(R,D,s,g,Y,e){var y,J,T,H,S,O,k,L,o,W,i=Y.min(e),A=Y.max(e),f=new xn(v);y=R.$55l(-1),J=D.$55l(3),T=s.$55l(-3),H=y.add(J.add(T.add(g))),S=new po(H.x,H.y),y=R.$55l(3),J=D.$55l(-6),T=s.$55l(3),H=y.add(J.add(T)),O=new po(H.x,H.y),y=R.$55l(-3),J=D.$55l(3),T=y.add(J),k=new po(T.x,T.y),L=new po(R.x,R.y),W=new po(Y.y-e.y,e.x-Y.x),o=Y.x*e.y-e.x*Y.y;for(var P=new Zl(W.$60l(S),W.$60l(O),W.$60l(k),W.$60l(L)+o).$51l(),Q=0;Q<P.length;Q++){var N=P[Q];if(N>=0&&1>=N){var M=R.lerp(D,N),I=D.lerp(s,N),d=s.lerp(g,N),b=M.lerp(I,N),p=I.lerp(d,N),G=b.lerp(p,N);Y.x==e.x?i.y<=G.y&&G.y<=A.y&&(f.$62l=n,f.$56l(G)):Y.y==e.y?i.x<=G.x&&G.x<=A.x&&(f.$62l=n,f.$56l(G)):G.gte(i)&&G.lte(A)&&(f.$62l=n,f.$56l(G))}}return f},Uc=function(O,A,f,x,N,i){var V=N.min(i),U=N.max(i),$=new oo(U.x,V.y),c=new oo(V.x,U.y),s=Mr(O,A,f,x,V,$),B=Mr(O,A,f,x,$,U),l=Mr(O,A,f,x,U,c),z=Mr(O,A,f,x,c,V),Y=new xn(v);return Y.$57l(s.points),Y.$57l(B.points),Y.$57l(l.points),Y.$57l(z.points),Y.points.length>0&&(Y.$62l=n),Y},Ob=function(w,S,h,E){var M=h.min(E),F=h.max(E),Y=new oo(F.x,M.y),o=new oo(M.x,F.y),R=mh(M,Y,w,S),i=mh(Y,F,w,S),t=mh(F,o,w,S),g=mh(o,M,w,S),V=new xn(v);return V.$57l(R.points),V.$57l(i.points),V.$57l(t.points),V.$57l(g.points),V.points.length>0&&(V.$62l=n),V},sh=p.XEditInteractor=function(p){var d=this,w=d._view=document.createElement("canvas");w.className="editCanvas",w.style.position="absolute",sh.superClass.constructor.call(d,p)};J.def(sh,p.Interactor,{ms_edit:1,setUp:function(){var S=this,I=S.gv,x=I.getView(),s=S._view;sh.superClass.setUp.call(S),I.setEditInteractor(S),I.$14l=s,I._79O?x.insertBefore(s,I._79O):x.appendChild(s);var F=S.$49l=S.$11l.bind(S);I.dm().md(F),I.sm().ms(F),I.mp(F)},tearDown:function(){var O=this,u=O.gv,F=u.getView(),U=O.$49l;sh.superClass.tearDown.call(O),u.setEditInteractor(w),u.$14l=w,F.removeChild(O._view),u.dm().umd(U),u.sm().ums(U),u.ump(U)},clear:function(){var H=this,z=H.gv;delete H._hoverSegmentIndex,delete H._edge,delete H._shape,delete z._editing,delete H.$10l,delete H.$13l,delete H.$9l,delete H._removePointIndex,delete H._lp,H.$12l="",delete H.$40l,delete H.$67l,delete H.$72l,delete H.$73l,delete H.$75l,delete H.$1l,delete H.$3l,delete H.$2l,delete H.$92l,delete H.$93l,delete H.$94l,H.clearDragging()},handle_keydown:function(x){this.$48l!==x.shiftKey&&(this.$48l=x.shiftKey,this.handle_mousemove(x,j,!0))},handle_keyup:function(C){this.$48l!==C.shiftKey&&(this.$48l=C.shiftKey,this.handle_mousemove(C,j,!0))},handle_touchstart:function(q){this.handle_mousemove(q),this.handle_mousedown(q)},handle_mousedown:function($){P($);var K=this,F=K.$13l,M=K.gv,D=M.dm(),e=D.getHistoryManager(),u=M.sm(),U=M.getZoom(),c=M.lp($),O=J.isDoubleClick($),t=J.isLeftButton($),H=K.$7l,h=K._shape,I=K._hoverSegmentIndex,W=K._edge,w=K.$87l,B=K.$88l,m=function(){K._68I||w===K.$87l&&B===K.$88l||K.$43l()};if(7!==K.$67l&&(delete K.$87l,delete K.$88l),t&&(h||W)&&I>=0&&O&&(h&&u.contains(h)||W&&u.contains(W))){var A=$q.call(K,h||W,I,c);return K.addShapePoint(h||W,I,A),G(function(){K.handle_mousemove($)},40),void 0}if(t&&(h||W)&&K._removePointIndex>=0&&O)return K.removeShapePoint(),K.$5l=1,G(function(){K.handle_mousemove($)},40),void 0;if(!t||!M._editing)return m(),void 0;if(h&&F>=0){var b=h.getPoints().get(F),g=h.p(),j=fg(g,b.x-g.x,b.y-g.y,-H+h.getRotation());N=fg(g,c.x-g.x,c.y-g.y,-H),K.$24l={x:N.x-j.x,y:N.y-j.y},K.startDragging($),e&&e.beginInteraction(),K.fi({kind:"beginEditPoint",event:$,data:h,index:F}),K.$88l=F,K.$87l=h}else if(K.$10l){var R=M.sm().getSelection(),y=K.$6l,n=K.$1l={},Y=K.$3l={},E=K.$16l[V[K.$10l]],Q={x:y.x,y:y.y},a={x:y.x+y.width/2,y:y.y+y.height/2};K.$24l={x:c.x-E.x/U,y:c.y-E.y/U},K.$2l=z(K.$8l),K.$4l=z(y),R.each(function(U){if(U instanceof C){var F=U.p(),e=U.getWidth(),G=U.getHeight(),w=fg(a,F.x-a.x,F.y-a.y,-H);n[U.getId()]={x:F.x-e/2,y:F.y-G/2,width:e,height:G},Y[U.getId()]={x:(w.x-Q.x)/y.width,y:(w.y-Q.y)/y.height}}}),K.startDragging($),e&&e.beginInteraction(),K.fi({kind:"beginEditRect",event:$,direction:K.$10l})}else if(W&&F>=0){var v=Gf(M.getDataUI(W),W.s("edge.points")),b=v.get(F);K.$24l={x:c.x-b.x,y:c.y-b.y},K.startDragging($),e&&e.beginInteraction(),K.fi({kind:"beginEditPoint",event:$,data:W,index:F}),K.$88l=F,K.$87l=W}else if(K.$40l){var y=K.$6l,a={x:y.x+y.width/2,y:y.y+y.height/2},X=z(K.$23l);X.x/=U,X.y/=U;var Z=fg(a,X.x-a.x,X.y-a.y,-H),N=fg(a,c.x-a.x,c.y-a.y,-H);K.$24l={x:N.x-Z.x,y:N.y-Z.y},K.startDragging($),e&&e.beginInteraction(),K.fi({kind:"beginEditRotation",event:$,data:K._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(K.$67l)>=0)K.startDragging($);else if(K.$71l&&O&&K.$79l(K.$71l,c)){var S=u.toSelection();e&&e.beginInteraction(),S.each(function(M){D.remove(M)}),e&&e.endInteraction()}m()},$11l:function(){var I=this,k=I.gv;k._editing&&(I.$13l==w||I._shape==w&&I._edge==w)&&(I.$73l==w||1!==I.$67l&&5!==I.$67l&&6!==I.$67l)||(I.$5l=1),I._68I=1},$46l:function(X){var m=this,I=m.gv,w=I.lp(X),r=[];return jg(I,function(B){var t=I.getDataUI(B);if(t){var J=t._79o();T(J,w)&&r.push(B)}}),r},$47l:function(y){var X=this,G=X.$13l,B=X.gv.dm(),s=B.getHistoryManager();X.$10l?(X.fi({kind:"endEditRect",event:y,direction:X.$10l}),s&&s.endInteraction()):X._shape&&G>=0?(X.fi({kind:"endEditPoint",event:y,data:X._shape,index:G}),s&&s.endInteraction()):X._edge&&G>=0?(X.fi({kind:"endEditPoint",event:y,data:X._edge,index:G}),s&&s.endInteraction()):X.$23l&&X.$40l&&(X.fi({kind:"endEditRotation",event:y}),s&&s.endInteraction())},handleWindowTouchEnd:function(N){this.handleWindowMouseUp(N)},handleWindowMouseUp:function(x){var V=this,M=V.gv,e=M.dm(),r=e.getHistoryManager(),_=V._shape,s=V._edge,Z=V.$13l,L=V.$40l,R=V.$9l,K=V.$10l,t=V.$67l;if((_||s)&&Z>=0&&R>=0){var D,U;if(_){var d=_.p(),B=_.getRotation();D=_.getPoints(),U=D.get(R),wn(_,d,B,Z,U,!1)}else if(D=Gf(M.getDataUI(s),s.s("edge.points"),!0),U=D.get(R),0===Z){var Q=D.get(0);s.s("edge.source.offset.x",U.x-Q.x),s.s("edge.source.offset.y",U.y-Q.y)}else if(Z===D.size()-1){var m=D.get(D.size()-1);s.s("edge.target.offset.x",U.x-m.x),s.s("edge.target.offset.y",U.y-m.y)}else"points"===s.s("edge.type")&&(D.set(Z,U),s.s("edge.points",Og(D)))}V.$47l(x);var i=V.$73l;1===t?(r&&r.beginInteraction(),i?M.sm().each(function(v){if(v.setHost&&M.isHelperEditable(v,"host")){v.setHost(i);var y=V.$75l,s=V.$74l;y&&(v.s("attach.row.index",y.rowIndex),v.s("attach.column.index",y.columnIndex)),s&&(v.s("attach.index",s.attachIndex),v.s("attach.offset",s.attachOffset),v.s("attach.offset.relative",!1),v.s("attach.offset.opposite",!1))
}}):M.sm().each(function(q){q.setHost&&M.isHelperEditable(q,"host")&&(q.setHost(w),q.s("attach.row.index",j),q.s("attach.column.index",j),q.s("attach.index",j),q.s("attach.offset",j),q.s("attach.offset.relative",!1),q.s("attach.offset.opposite",!1))}),r&&r.endInteraction()):2===t?(r&&r.beginInteraction(),i?M.sm().each(function(c){c.setParent&&M.isHelperEditable(c,"parent")&&c.setParent(i)}):M.sm().each(function(B){B.setParent&&M.isHelperEditable(B,"parent")&&B.setParent(w)}),r&&r.endInteraction()):3===t?i&&(r&&r.beginInteraction(),M.sm().each(function(Z){if(M.isHelperEditable(Z,"edge")&&Z instanceof C&&i instanceof C){var O=new S.Edge;e.add(O),O.setSource(Z),O.setTarget(i),V.onEdgeCreated&&V.onEdgeCreated(x,O)}}),r&&r.endInteraction()):(5===t||6===t)&&i&&(r&&r.beginInteraction(),M.sm().each(function(q){q instanceof E&&i instanceof C&&(5===t&&M.isHelperEditable(q,"source")?q.setSource(i):6===t&&M.isHelperEditable(q,"source")&&q.setTarget(i))}),r&&r.endInteraction()),(K||L)&&V.$43l(!0),g?(V.clear(),delete V.$64l,V._68I||V.$43l()):(V.handle_mousemove(x,!0),t&&!V._68I&&V.$43l())},handleWindowTouchMove:function(l){this.handleWindowMouseMove(l)},handleWindowMouseMove:function(B){this._78I(B)},handle_mousemove:function($,Z,K){if(!this._pause){if(!K){var W=g?ji($):$;this.$61l={clientX:W.clientX,clientY:W.clientY}}if(Z===!0||!t()){var P=this,R=P.gv,u=!1,j=w;P.clear(),R.sm().size()>0&&(j=R.lp(K?P.$61l:$),u=P._79I($,j)),u&&(R._editing=1),P.$12l!==P.$65l&&(P.$65l=P.$12l,P.setCursor(P.$12l)),P.$40l!==P.$64l&&(P.$64l=P.$40l,P._68I||P.$43l()),P._hoverSegmentIndex!==P.$66l&&(P.$66l=P._hoverSegmentIndex,P._68I||P.$43l())}}},_78I:function(T){this.autoScroll(T);var B=this,l=B.gv,k=l.lp(T),$=l.getZoom(),K=B.$13l;if((B._shape||B._edge)&&K>=0){var g,t,L,m=B._shape,v=B._edge,A=B.$24l,d=l.getPointSnapSpacing(),n=function(y,E){return d==w||isNaN(d)?{x:y,y:E}:{x:f(y/d)*d,y:f(E/d)*d}};if(m){g=m.getPoints();var y=m.p(),p=m.getRotation(),b=0;t=fg(y,k.x-y.x,k.y-y.y,-p),wn(m,y,p,K,k,!0,A,n),B.fi({kind:"betweenEditPoint",event:T,data:m,index:K})}else if(v){g=Gf(l.getDataUI(v),v.s("edge.points"),!0),k.x-=A.x,k.y-=A.y,t=k;var z,o;if(0===K){var H=g.get(0);z=k.x-H.x,o=k.y-H.y,L=n(z,o),v.s("edge.source.offset.x",L.x),v.s("edge.source.offset.y",L.y)}else if(K===g.size()-1){var V=g.get(g.size()-1);z=k.x-V.x,o=k.y-V.y,L=n(z,o),v.s("edge.target.offset.x",L.x),v.s("edge.target.offset.y",L.y)}else"points"===v.s("edge.type")&&(L=n(k.x,k.y),L.e=g.get(K).e,g.set(K,L),v.s("edge.points",Og(g)));B.fi({kind:"betweenEditPoint",event:T,data:v,index:K})}if(delete B.$9l,l.isSnapPoint(m)||l.isSnapPoint(v))for(b=0;b<g.size();b++)if(b!==K){var I=g.get(b);if(Q(I,t)<l.getEditPointSize()/$){B.$9l=b;break}}}else if(B.$10l){var A=B.$24l;k.x-=A.x,k.y-=A.y;var c=l.sm().getSelection(),Y=B.$1l,S=B.$7l,X=B.$10l,P=B.$4l,F=B.$2l,q=l.getEditRectPadding()/$,Z=2*q,i=l.getSnapSpacing(),h=i!=w&&!isNaN(i),R=Xc(F,k,X,S,2*q,l.getResizeMode(),h,!0),s=B.$6l;if(h){var U=R.width-Z,a=R.height-Z,u=f(U/i)*i,D=f(a/i)*i,_=u-U,j=D-a;("west"===X||"northwest"===X||"southwest"===X)&&(_=-_),("north"===X||"northwest"===X||"northeast"===X)&&(j=-j),R=Xc(F,k,X,S,2*q,l.getResizeMode(),h,!1,_,j)}B.$8l=R,s.x=R.x+q,s.y=R.y+q,s.width=R.width-Z,s.height=R.height-Z;var Sj=R.x+R.width/2,cg=R.y+R.height/2,Ce=s.x,Aj=s.y,Bi=s.width/P.width,jb=s.height/P.height;c.each(function(O){if(O instanceof C&&l.isEditable(O)&&l.isRectEditable(O)){var c=Y[O.getId()],v=B.$3l[O.getId()],L={x:c.x+c.width/2,y:c.y+c.height/2},E=0,K=0,F=X,i=180*M(S-O.getRotation())/N;"northeast"===X?i>=315||45>i?(E=c.width*Bi+c.x,K=c.height*(1-jb)+c.y,F="northeast"):i>=45&&135>i?(E=c.width*(1-jb)+c.x,K=c.height*(1-Bi)+c.y,F="northwest"):i>=135&&225>i?(E=c.width*(1-Bi)+c.x,K=c.height*jb+c.y,F="southwest"):(E=c.width*jb+c.x,K=c.height*Bi+c.y,F="southeast"):"north"===X?i>=315||45>i?(K=c.height*(1-jb)+c.y,F="north"):i>=45&&135>i?(E=c.width*(1-jb)+c.x,F="west"):i>=135&&225>i?(K=c.height*jb+c.y,F="south"):(E=c.width*jb+c.x,F="east"):"northwest"===X?i>=315||45>i?(E=c.width*(1-Bi)+c.x,K=c.height*(1-jb)+c.y,F="northwest"):i>=45&&135>i?(E=c.width*(1-jb)+c.x,K=c.height*Bi+c.y,F="southwest"):i>=135&&225>i?(E=c.width*Bi+c.x,K=c.height*jb+c.y,F="southeast"):(E=c.width*jb+c.x,K=c.height*(1-Bi)+c.y,F="northeast"):"west"===X?i>=315||45>i?(E=c.width*(1-Bi)+c.x,F="west"):i>=45&&135>i?(K=c.height*Bi+c.y,F="south"):i>=135&&225>i?(E=c.width*Bi+c.x,F="east"):(K=c.height*(1-Bi)+c.y,F="north"):"southwest"===X?i>=315||45>i?(E=c.width*(1-Bi)+c.x,K=c.height*jb+c.y,F="southwest"):i>=45&&135>i?(E=c.width*jb+c.x,K=c.height*Bi+c.y,F="southeast"):i>=135&&225>i?(E=c.width*Bi+c.x,K=c.height*(1-jb)+c.y,F="northeast"):(E=c.width*(1-jb)+c.x,K=c.height*(1-Bi)+c.y,F="northwest"):"east"===X?i>=315||45>i?(E=c.width*Bi+c.x,F="east"):i>=45&&135>i?(K=c.height*(1-Bi)+c.y,F="north"):i>=135&&225>i?(E=c.width*(1-Bi)+c.x,F="west"):(K=c.height*Bi+c.y,F="south"):"south"===X?i>=315||45>i?(K=c.height*jb+c.y,F="south"):i>=45&&135>i?(E=c.width*jb+c.x,F="east"):i>=135&&225>i?(K=c.height*(1-jb)+c.y,F="north"):(E=c.width*(1-jb)+c.x,F="west"):"southeast"===X&&(i>=315||45>i?(E=c.width*Bi+c.x,K=c.height*jb+c.y,F="southeast"):i>=45&&135>i?(E=c.width*jb+c.x,K=c.height*(1-Bi)+c.y,F="northeast"):i>=135&&225>i?(E=c.width*(1-Bi)+c.x,K=c.height*(1-jb)+c.y,F="northwest"):(E=c.width*(1-jb)+c.x,K=c.height*Bi+c.y,F="southwest"));var V=fg(L,E-L.x,K-L.y,O.getRotation());Tc(O,c,F,{x:V.x,y:V.y});var H=Ce+s.width*v.x,G=Aj+s.height*v.y,I={x:H,y:G};I=fg({x:Sj,y:cg},I.x-Sj,I.y-cg,S),O.p(I.x,I.y)}}),B.fi({kind:"betweenEditRect",event:T,direction:X})}else if(B.$23l&&B.$40l){var yk=B.$8l,Ac=yk.width,$k=yk.height,y={x:yk.x+Ac/2,y:yk.y+$k/2},A=B.$24l,Pe=B.$23l,vj=Pe.x/$-y.x,Ki=Pe.y/$-y.y,Or=e(vj*vj+Ki*Ki),hs=Math.asin(A.x/Or),ys=l.sm().getSelection(),xn=W+x(k.y-y.y,k.x-y.x)-hs,Ec=l.getSnapAngle(),xn=f(xn/Ec)*Ec;0>xn&&(xn+=r);var sq=xn-B.$7l,Pd=[y.x,0,y.y];ys.each(function(H){if(l.isEditable(H)&&l.isRotationEditable(H)&&l.isVisible(H)){var T=Cd(H.p3(),Pd),S=aj();ts(S,-sq),H.setRotation(H.getRotation()+sq),Cp(T,S),H.p3(Pd[0]+T[0],Pd[1]+T[1],Pd[2]+T[2])}}),B.$7l=xn,B.fi({kind:"betweenEditRotation",event:T})}else if([1,2,3,5,6].indexOf(B.$67l)>=0)B.$72l=T,B.$78l||(B.$78l=1,G(function(){J.isDragging()&&B.$43l(),delete B.$78l},12));else if(7===B.$67l){if(B.$87l instanceof O){var m=B.$87l,Gi=B.$88l,Ej=J.clone(m.getPoints().get(Gi)),ei=k.y-Ej.y;Ej.e||(Ej.e=0),B.$92l||(B.$92l=Ej.e),Ej.e=B.$92l-ei,m.setPoint(Gi,Ej)}else if(B.$87l instanceof E){var v=B.$87l,Gi=B.$88l,g=Gf(l.getDataUI(v),v.s("edge.points")),Ej=g.get(Gi),ei=k.y-Ej.y;Ej.e||(Ej.e=0),B.$92l||(B.$92l=Ej.e),Ej.e=B.$92l-ei,g.set(Gi,Ej),v.s("edge.points",Og(g))}}else if(8===B.$67l){var ys=l.sm().getSelection(),Cc=B.$93l;Cc||(Cc=B.$93l={}),ys.each(function(T){if(T.p3){var l=T.p3(),L=Cc[T.getId()];L==w&&(L=Cc[T.getId()]=l[1]),T.p3([l[0],L-(k.y-B.$90l.y/$),l[2]])}})}else if(9===B.$67l){var ys=l.sm().getSelection(),ui=B.$94l;ui||(ui=B.$94l={}),ys.each(function(G){if(G.s3){var K=G.s3(),u=ui[G.getId()];u==w&&(u=ui[G.getId()]=K[1]);var Z=u-(k.y-B.$91l.y/$);0>Z&&(Z=.01),G.s3([K[0],Z,K[2]])}})}},$79l:function(R,i){var o=this,B=o.gv,z=B.getZoom(),_=B.getEditHelperSize(),p=R.x/z,a=R.y/z,v=_/z,W=v/2;return T({x:p-W,y:a-W,width:v,height:v},i)?!0:void 0},_79I:function(H,f){var Q=this,G=Q.gv,y=G.getZoom(),m=G.getEditPointSize(),t=m/y,s=t/2;if(Q.$16l){var S,j=Q.$16l,x=j[3].x-j[7].x,o=j[3].y-j[7].y,k=e(x*x+o*o),g=j[1].x-j[5].x,X=j[1].y-j[5].y,V=e(g*g+X*X),v={x:f.x*y,y:f.y*y};if(Q._80I(v,0,j[0],"northwest",k,V)||Q._80I(v,1,j[1],"north",k,V)||Q._80I(v,2,j[2],"northeast",k,V)||Q._80I(v,7,j[7],"west",k,V)||Q._80I(v,3,j[3],"east",k,V)||Q._80I(v,6,j[6],"southwest",k,V)||Q._80I(v,5,j[5],"south",k,V)||Q._80I(v,4,j[4],"southeast",k,V))return!0}if(Q.$23l){var F=Q.$23l,w=F.x/y,I=F.y/y;if(T({x:w-s,y:I-s,width:t,height:t},f))return Q.$40l=1,Q.$12l="crosshair",!0}if(Q.$68l&&Q.$79l(Q.$68l,f))return Q.$67l=1,Q.$12l="crosshair",!0;if(Q.$69l&&Q.$79l(Q.$69l,f))return Q.$67l=2,Q.$12l="crosshair",!0;if(Q.$70l&&Q.$79l(Q.$70l,f))return Q.$67l=3,Q.$12l="crosshair",!0;if(Q.$71l&&Q.$79l(Q.$71l,f))return Q.$67l=4,Q.$12l="crosshair",!0;if(Q.$82l&&Q.$79l(Q.$82l,f))return Q.$67l=5,Q.$12l="crosshair",!0;if(Q.$83l&&Q.$79l(Q.$83l,f))return Q.$67l=6,Q.$12l="crosshair",!0;if(Q._pointElevationHelperPoint&&Q.$79l(Q._pointElevationHelperPoint,f))return Q.$67l=7,Q.$12l="crosshair",!0;if(Q.$90l&&Q.$79l(Q.$90l,f))return Q.$67l=8,Q.$12l="crosshair",!0;if(Q.$91l&&Q.$79l(Q.$91l,f))return Q.$67l=9,Q.$12l="crosshair",!0;for(var Z=Q.$46l(H),L=0;L<Z.length;L++){var S,D,J=Z[L],n=G.getDataUI(J);if(n&&n._55O){var l=n._55O;if(l._43O&&J instanceof E){if(S=J.s("edge.points"),S=Gf(n,S),D=J.s("edge.segments"),D||(D=ol(S)),Q.$42l(J,f,S._as,D,"edge"))return!0;"points"===J.s("edge.type")&&Q.$41l(J,f,S._as,D,"edge")}if(l._43O&&J instanceof O&&l.$15l&&l.$15l.length===J.getPoints().size()){if(S=l.$15l,D=J.getSegments(),D||(D=ol(S)),Q.$42l(J,f,S,D,"shape"))return!0;Q.$41l(J,f,S,D,"shape")}}}return!1},_80I:function(i,P,Q,m,U,q){var $=this,l=$.gv,O=l.getEditPointSize(),e=O/2,R=l.sm(),p=l.isDirectionEditable;if(p&&1===R.size()){var f=R.ld();if(p=p.bind(l),f instanceof C){if(!p(f,m))return!1;if("east"===m){if(p(f,"northeast")&&p(f,"southeast")&&2*O>=q)return!1}else if("west"===m){if(p(f,"northwest")&&p(f,"southwest")&&2*O>=q)return!1}else if("north"===m){if(p(f,"northwest")&&p(f,"northeast")&&2*O>=U)return!1}else if("south"===m&&p(f,"southwest")&&p(f,"southeast")&&2*O>=U)return!1}}else{if(2*O>=U&&("north"===m||"south"===m))return!1;if(2*O>=q&&("east"===m||"west"===m))return!1}if(T({x:Q.x-e,y:Q.y-e,width:O,height:O},i)){if($.$10l!==m){var c=180*$.$7l/N,a="";c>=337.5||22.5>c?a="north":c>=22.5&&67.5>c?a="northeast":c>=67.5&&112.5>c?a="east":c>=112.5&&157.5>c?a="southeast":c>=157.5&&202.5>c?a="south":c>=202.5&&247.5>c?a="southwest":c>=247.5&&292.5>c?a="west":c>=292.5&&337.5>c&&(a="northwest");var D=Rl.indexOf(a),a=Rl[P-(1-D)+8];switch(a){case"northwest":$.$12l="nwse-resize";break;case"northeast":$.$12l="nesw-resize";break;case"southwest":$.$12l="nesw-resize";break;case"southeast":$.$12l="nwse-resize";break;case"north":$.$12l="ns-resize";break;case"east":$.$12l="ew-resize";break;case"south":$.$12l="ns-resize";break;case"west":$.$12l="ew-resize"}$.$10l=m}return!0}return!1},$42l:function(q,M,Z,v,y){var x,X=this,z=X.gv,P=z.getEditPointSize(),c=P/z.getZoom(),g=-1,E={x:M.x,y:M.y,width:0,height:0},C=function(r){"shape"===y?X._shape=q:X._edge=q,X._removePointIndex=r},R=function(d){"shape"===y?X._shape=q:X._edge=q,X.$13l=d,X.$12l="crosshair"};for(d(E,c/2),g=Z.length-1,x=v.size()-1;x>=0;x--){var O=v.get(x);if(1===O||2===O)g-=1;else if(3===O){var m=Z[g-1];if(T(E,m))return R(g-1),!0;g-=2}else if(4===O){var U=Z[g-1],h=Z[g-2];if(T(E,U))return R(g-1),!0;if(T(E,h))return R(g-2),!0;g-=3}}for(g=Z.length-1,x=v.size()-1;x>=0;x--){var O=v.get(x),H=Z[g];if(T(E,H))return C(g),R(g),!0;1===O||2===O?g-=1:3===O?g-=2:4===O&&(g-=3)}return!1},$41l:function(D,H,$,V,B){var X=this,I=X.gv,c=-1,f=0,Z={x:H.x,y:H.y,width:0,height:0},J=function(u,z){X._hoverSegmentIndex=z,X._lp=H,"shape"===B?X._shape=D:X._edge=D};for(d(Z,I.getSegmentHoverWidth()/2/I.getZoom()),D instanceof O&&D.isClosePath()&&V.indexOf(5)<0&&(V=new i(V._as),V.add(5));f<V.size();f++){var j=V.get(f);if(1===j){var x=$[c],u=$[c+1];if(x){var q=Ob(new oo(x.x,x.y),new oo(u.x,u.y),new oo(Z.x,Z.y),new oo(Z.x+Z.width,Z.y+Z.height));if(q.$62l===n&&q.points.length>0)return J(q,f),!0}c+=1}else if(2===j){var x=$[c],u=$[c+1],q=Ob(new oo(x.x,x.y),new oo(u.x,u.y),new oo(Z.x,Z.y),new oo(Z.x+Z.width,Z.y+Z.height));if(q.$62l===n&&q.points.length>0)return J(q,f),!0;c+=1}else if(3===j){var x=$[c],p=$[c+1],S=$[c+2],q=ph(new oo(x.x,x.y),new oo(p.x,p.y),new oo(S.x,S.y),new oo(Z.x,Z.y),new oo(Z.x+Z.width,Z.y+Z.height));if(q.$62l===n)return J(q,f),!0;c+=2}else if(4===j){var x=$[c],o=$[c+1],L=$[c+2],S=$[c+3],q=Uc(new oo(x.x,x.y),new oo(o.x,o.y),new oo(L.x,L.y),new oo(S.x,S.y),new oo(Z.x,Z.y),new oo(Z.x+Z.width,Z.y+Z.height));if(q.$62l===n)return J(q,f),!0;c+=3}else if(5===j){var x=$[c],u=$[0];if(x){var q=Ob(new oo(x.x,x.y),new oo(u.x,u.y),new oo(Z.x,Z.y),new oo(Z.x+Z.width,Z.y+Z.height));if(q.$62l===n&&q.points.length>0)return J(q,f),!0}}}return!1},addShapePoint:function(f,d,B){var C=this,t=C.gv,u=t.dm(),H=u.getHistoryManager();if(H&&H.beginInteraction(),0===arguments.length&&(f=C._shape||C._edge,d=C._hoverSegmentIndex,B=C._lp),f instanceof O||f instanceof E){var A=ah(f,t.getDataUI(f),d);if(!isNaN(d)&&B&&!isNaN(A)){var D=B;if(f instanceof O){var Z=f.p(),e=f.getRotation(),x=f.toSegments();x||(x=ol(f.getPoints())),f.isClosePath()&&x.indexOf(5)<0&&(x=new i(x._as),x.add(5));var j=x.get(d),W="addPoint",y="removePointAt";if(2===j||1===j){var k={x:D.x,y:D.y};x.add(j,d),k=fg(Z,k.x-Z.x,k.y-Z.y,-e),f[W](k,A+1)}else if(3===j){var M=f.getPoints(),h=M.get(A),c=M.get(A+2),k={x:D.x,y:D.y};k=fg(Z,k.x-Z.x,k.y-Z.y,-e);var p=Mf(h,k),$=Mf(k,c);x.removeAt(d),x.add(3,d),x.add(3,d),f.setPoint(A+1,k),f[W]($,A+2),f[W](p,A+1)}else if(4===j){var M=f.getPoints(),h=M.get(A),c=M.get(A+3),k={x:D.x,y:D.y};k=fg(Z,k.x-Z.x,k.y-Z.y,-e);var p=Rn(h,k),$=zc(h,k),P=Rn(k,c),w=zc(k,c);x.removeAt(d),x.add(4,d),x.add(4,d),f[y](A+1),f[y](A+1),f[W](k,A+1),f[W](w,A+2),f[W](P,A+2),f[W]($,A+1),f[W](p,A+1)}else if(5===j){var k={x:D.x,y:D.y};x.add(2,d),k=fg(Z,k.x-Z.x,k.y-Z.y,-e),f[W](k,A+1)}f.isClosePath()&&x.remove(5),f.setSegments(x);var o=f.getWidth(),K=f.getHeight(),q=f.p().x-o/2,N=f.p().y-K/2;q-=Z.x,N-=Z.y;var V=Wc(f,{x:q,y:N,width:o,height:K},e,Z);f.p(V.x,V.y)}else if(f instanceof E){if("points"!==f.s("edge.type"))return H&&H.endInteraction(),void 0;var M=f.s("edge.points");x=f.s("edge.segments"),M=Gf(t.getDataUI(f),M),x||(x=ol(M)),x=new i(x._as.slice(0)),M=new i(M._as.slice(0));var j=x.get(d);if(2===j||1===j){var k={x:D.x,y:D.y};x.add(j,d),M.add(k,A+1)}else if(3===j){var h=M.get(A),c=M.get(A+2),k={x:D.x,y:D.y},p=Mf(h,k),$=Mf(k,c);x.removeAt(d),x.add(3,d),x.add(3,d),M.set(A+1,k),M.add($,A+2),M.add(p,A+1)}else if(4===j){var h=M.get(A),c=M.get(A+3),k={x:D.x,y:D.y},p=Rn(h,k),$=zc(h,k),P=Rn(k,c),w=zc(k,c);x.removeAt(d),x.add(4,d),x.add(4,d),M.removeAt(A+1),M.removeAt(A+1),M.add(k,A+1),M.add(w,A+2),M.add(P,A+2),M.add($,A+1),M.add(p,A+1)}f.s("edge.points",Og(M)),f.s("edge.segments",x)}}}H&&H.endInteraction()},removeShapePoint:function(I,B){var j=this,K="removeAt",d=j.gv,A=d.dm(),q=A.getHistoryManager();if(q&&q.beginInteraction(),0===arguments.length&&(I=j._shape||j._edge,B=j._removePointIndex),B>=0&&(I instanceof O||I instanceof E)){var k=Ul(I,j.gv.getDataUI(I),B),_=B;if(I instanceof O){var t=I.p(),z=I.toSegments();z||(z=ol(I.getPoints()));var f=z.get(k),S="removePointAt";if(1===f&&0===_)if(I.getPoints().size()>1){var G=z.get(k+1);z[K](k+1),3===G?I[S](_+1):4===G&&(I[S](_+2),I[S](_+1)),I[S](_)}else I.dm().remove(I);else 2===f||1===f?(z[K](k),I[S](_)):3===f?(z[K](k),I[S](_),I[S](_-1)):4===f&&(z[K](k),I[S](_),I[S](_-1),I[S](_-2));I.setSegments(z);var C=I.getWidth(),w=I.getHeight(),R=I.p().x-C/2,n=I.p().y-w/2;R-=t.x,n-=t.y;var P=Wc(I,{x:R,y:n,width:C,height:w},I.getRotation(),t);I.p(P.x,P.y)}else if(I instanceof E){if("points"!==I.s("edge.type"))return q&&q.endInteraction(),void 0;var M=I.s("edge.points");if(z=I.s("edge.segments"),M&&(M=Gf(j.gv.getDataUI(I),M),z||(z=ol(M))),0===B||B===M.size()-1)return q&&q.endInteraction(),void 0;z=new i(z._as.slice(0)),M=new i(M._as.slice(0));var f=z.get(k);2===f||1===f?(z[K](k),M[K](_)):3===f?(z[K](k),M[K](_),M[K](_-1)):4===f&&(z[K](k),M[K](_),M[K](_-1),M[K](_-2)),I.s("edge.segments",z),I.s("edge.points",Og(M))}}q&&q.endInteraction()},changeShapeSegment:function(v,R,D){var L=this,H=L.gv,l=H.dm(),x=l.getHistoryManager();if(x&&x.beginInteraction(),1!==arguments.length||isNaN(v)||(D=v,v=L._shape||L._edge,R=L._hoverSegmentIndex),v instanceof O||v instanceof E){var m=ah(v,L.gv.getDataUI(v),R);if(!isNaN(R)&&!isNaN(m))if(v instanceof O){var W=v.p(),s=v.toSegments();s||(s=ol(v.getPoints()));var b=s.get(R),u=v.toPoints();if(1===D||2===D)1===b||2===b?s.set(R,D):3===b?(s.set(R,D),u.removeAt(m+1)):4===b&&(s.set(R,D),u.removeAt(m+1),u.removeAt(m+1));else if(3===D){var c=function(){var o=u.get(m),w=u.get(m+1),h=Mf(o,w);s.set(R,3),u.add(h,m+1)};2===b||1===b?c():4===b&&(u.removeAt(m+1),u.removeAt(m+1),c())}else if(4===D){var w=function(){var t=u.get(m),v=u.get(m+1),p=Rn(t,v),N=zc(t,v);s.set(R,4),u.add(p,m+1),u.add(N,m+2)};2===b||1===b?w():3===b&&(u.removeAt(m+1),w())}v.setSegments(s),v.setPoints(u);var Y=v.getWidth(),U=v.getHeight(),g=v.p().x-Y/2,k=v.p().y-U/2;g-=W.x,k-=W.y;var a=new Wc(v,{x:g,y:k,width:Y,height:U},v.getRotation(),W);v.p(a.x,a.y)}else if(v instanceof E){if("points"!==v.s("edge.type"))return x&&x.endInteraction(),void 0;var u=v.s("edge.points");s=v.s("edge.segments"),u&&(u=Gf(L.gv.getDataUI(v),u),s||(s=ol(u))),s=new i(s._as.slice(0)),u=new i(u._as.slice(0));var b=s.get(R);if(1===D||2===D)1===b||2===b?s.set(R,D):3===b?(s.set(R,D),u.removeAt(m+1)):4===b&&(s.set(R,D),u.removeAt(m+1),u.removeAt(m+1));else if(3===D){var c=function(){var z=u.get(m),h=u.get(m+1),A=Mf(z,h);s.set(R,3),u.add(A,m+1)};2===b||1===b?c():4===b&&(u.removeAt(m+1),u.removeAt(m+1),c())}else if(4===D){var w=function(){var c=u.get(m),i=u.get(m+1),B=Rn(c,i),w=zc(c,i);s.set(R,4),u.add(B,m+1),u.add(w,m+2)};2===b||1===b?w():3===b&&(u.removeAt(m+1),w())}v.s("edge.points",Og(u)),v.s("edge.segments",s)}}x&&x.endInteraction()},getDefaultSegments:function(a){var V=this.gv,x=V.getDataUI(a);if(a instanceof E){var H=a.s("edge.points");return H=Gf(x,H),ol(H)}if(a instanceof O){var H=a.getPoints(),m=a.getSegments();return m&&m.size()>0?m:ol(H)}},$43l:function(q){var S=this;q&&(S.$5l=1),S._68I=1,S._42()},_42:function(){var N=this;if(N._68I){delete N._68I;var p=N.gv,Z=N.$5l,b=p.getZoom(),c=p.getEditPointSize(),T=c/2,j=new i,H=N._view,A=N._edge,B=N._shape,G=H.getContext("2d"),l=p.tx(),_=p.ty(),f=w,L=p.getEditPointBackground(),g=p.getControlPointBackground(),u=p.getControlPointBorderColor(),V=p.getEditPointBorderColor(),y=p.getEditRectBorderColor(),o=p.getDirectionLineColor(),s=p.getSegmentHoverColor(),Y=p.getSnapPointBorderColor(),X=p.getJoinPointBackground(),x=p.getJoinPointBorderColor(),W=p.getSegmentHoverWidth(),v=[5,5],k=p.getEditRectBorderStyle();Hn(p,function(y){p.isSelected(y)&&p.isVisible(y)&&j.add(y)}),G.clearRect(0,0,a(H.width),a(H.height)),G.save(),K.translateAndScale(G,l,_,1);var P=w,M={x:0,y:0,width:0,height:0},t=0,$=0,U=0,I=0,n=0,Q=0,ph=0,_j=0,fn=0,Ee=0,dj=[];if(Z?(delete N.$6l,delete N.$8l,delete N.$7l,delete N.$16l,delete N.$23l):(P=N.$6l,f=N.$7l),delete N.$68l,delete N.$69l,delete N.$71l,delete N.$70l,delete N.$82l,delete N.$83l,delete N._pointElevationHelperPoint,delete N.$90l,delete N.$91l,delete N.$75l,delete N.$74l,j.each(function(d){var J=p.getDataUI(d);if(J){var l=J._55O;if(p.isEditable(d))l._56O&&d instanceof C&&$++,dj.push(d),l._42O&&d instanceof C&&t++,p.isHelperEditable(d,"host")&&I++,p.isHelperEditable(d,"parent")&&U++,p.isHelperEditable(d,"remove")&&n++,p.isHelperEditable(d,"edge")&&Q++,p.isHelperEditable(d,"source")&&ph++,p.isHelperEditable(d,"target")&&_j++,p.isHelperEditable(d,"elevation")&&fn++,p.isHelperEditable(d,"tall")&&Ee++;else if(d instanceof m&&d.isExpanded()){var e=!0,P=p.getEditableFunc();P&&(e=P(d)),e&&(p.isHelperEditable(d,"host")&&I++,p.isHelperEditable(d,"parent")&&U++,p.isHelperEditable(d,"remove")&&n++,p.isHelperEditable(d,"edge")&&Q++,p.isHelperEditable(d,"source")&&ph++,p.isHelperEditable(d,"target")&&_j++,p.isHelperEditable(d,"elevation")&&fn++,p.isHelperEditable(d,"tall")&&Ee++,dj.push(d))}}}),G.beginPath(),G.lineWidth=1,G.strokeStyle=p.getNodeBorderColor(),dj.forEach(function(A){var H=p.getDataUI(A),q=H._55O;if(Z)if(f==w&&(f=A instanceof E?0:A instanceof m&&A.isExpanded()?0:A.getRotation(),N.$7l=f),P==w){var T,U,B;if(A instanceof m&&A.isExpanded()||A instanceof E){var Q=p.getDataUIBounds(A);U=Q.width,B=Q.height,T={x:Q.x+U/2,y:Q.y+B/2}}else T=A.p(),U=A.getWidth(),B=A.getHeight();P={x:T.x,y:T.y,width:0,height:0},M.x=T.x-U/2,M.y=T.y-B/2,M.width=U,M.height=B,P=F(P,M)}else{var T,U,B,l,k=P.x+P.width/2,V=P.y+P.height/2,c={x:k,y:V};if(A instanceof m&&A.isExpanded()||A instanceof E){l=0;var Q=p.getDataUIBounds(A);U=Q.width,B=Q.height,T={x:Q.x+U/2,y:Q.y+B/2}}else T=A.p(),U=A.getWidth(),B=A.getHeight(),l=A.getRotation();var L={x:T.x-U/2,y:T.y-B/2,width:U,height:B},o={x:L.x,y:L.y},K={x:L.x+L.width,y:L.y},j={x:L.x,y:L.y+L.height},J={x:L.x+L.width,y:L.y+L.height},o=fg(T,o.x-T.x,o.y-T.y,l),j=fg(T,j.x-T.x,j.y-T.y,l),J=fg(T,J.x-T.x,J.y-T.y,l),K=fg(T,K.x-T.x,K.y-T.y,l),$=-f,S=fg(c,o.x-c.x,o.y-c.y,$),u=fg(c,K.x-c.x,K.y-c.y,$),v=fg(c,j.x-c.x,j.y-c.y,$),i=fg(c,J.x-c.x,J.y-c.y,$),z=R([S,u,v,i]);P=F(P,z),P.x-=k,P.y-=V;var h=Wc(w,P,f,c);P.x=h.x-P.width/2,P.y=h.y-P.height/2}if(t>1&&p.isEditable(A)&&p.isRectEditable(A)&&A instanceof C){var O=A.getRect(),a=q.$45l,Y=Vk(a[0],b),D=Vk(a[2],b),r=Vk(a[4],b),y=Vk(a[6],b);A.getRotation()?(G.moveTo(Y.x,Y.y),G.lineTo(D.x,D.y),G.lineTo(r.x,r.y),G.lineTo(y.x,y.y),G.lineTo(Y.x,Y.y)):G.rect(O.x*b,O.y*b,O.width*b,O.height*b)}}),G.stroke(),j.each(function(H){var C=p.getDataUI(H);if(C){var c,a,y=C._55O,M=C._78o;if(y&&y._43O&&H instanceof O?(c=y.$15l,a=H.getSegments(),a||(a=ol(c)),H.isClosePath()&&a.indexOf(5)<0&&(a=new i(a._as),a.add(5))):y&&M&&y._43O&&(c=H.s("edge.points"),a=H.s("edge.segments"),c=Gf(C,c),a||(a=ol(c)),c&&(c=c._as)),c&&a){var J=0,f=a.size(),L=N._hoverSegmentIndex;c=c.slice(0);for(var m=0;m<c.length;m++)c[m]=Vk(c[m],b);G.beginPath(),G.strokeStyle=o,G.lineWidth=1,J=0;for(var m=0;f>m;m++){var Z=a.get(m);if(1===Z||2===Z)J++;else if(3===Z){var K=c[J-1],h=c[J],n=c[J+1];G.moveTo(K.x,K.y),G.lineTo(h.x,h.y),G.lineTo(n.x,n.y),J+=2}else if(4===Z){var K=c[J-1],P=c[J],q=c[J+1],n=c[J+2];G.moveTo(K.x,K.y),G.lineTo(P.x,P.y),G.moveTo(q.x,q.y),G.lineTo(n.x,n.y),J+=3}}if(G.stroke(),B===H||A===H&&"points"===A.s("edge.type")){G.beginPath(),J=0,G.strokeStyle=s,G.lineWidth=W;for(var m=0;f>m;m++){var Z=a.get(m);if(1===Z||2===Z){if(L===m){var K=c[J-1],n=c[J];G.moveTo(K.x,K.y),G.lineTo(n.x,n.y);break}J++}else if(3===Z){if(L===m){var K=c[J-1],h=c[J],n=c[J+1];G.moveTo(K.x,K.y),G.quadraticCurveTo(h.x,h.y,n.x,n.y);break}J+=2}else if(4===Z){if(L===m){var K=c[J-1],P=c[J],q=c[J+1],n=c[J+2];G.moveTo(K.x,K.y),G.bezierCurveTo(P.x,P.y,q.x,q.y,n.x,n.y);break}J+=3}else if(5===Z&&L===m){var K=c[J-1],n=c[0];G.moveTo(K.x,K.y),G.lineTo(n.x,n.y);break}}G.stroke()}G.beginPath(),J=0,G.strokeStyle=x,G.lineWidth=1,G.fillStyle=X;for(var m=0;f>m;m++){var Z=a.get(m);if(1===Z||2===Z){var n=c[J];G.moveTo(n.x+T,n.y),G.arc(n.x,n.y,T,0,r,!0),J++}else if(3===Z){var n=c[J+1];G.moveTo(n.x+T,n.y),G.arc(n.x,n.y,T,0,r,!0),J+=2}else if(4===Z){var n=c[J+2];G.moveTo(n.x+T,n.y),G.arc(n.x,n.y,T,0,r,!0),J+=3}}G.fill(),G.stroke(),G.beginPath(),J=0,G.strokeStyle=u,G.lineWidth=1,G.fillStyle=g;for(var m=0;f>m;m++){var Z=a.get(m);if(1===Z||2===Z)J++;else if(3===Z){var h=c[J];G.moveTo(h.x+T,h.y),G.arc(h.x,h.y,T,0,r,!0),J+=2}else if(4===Z){var P=c[J],q=c[J+1];G.moveTo(P.x+T,P.y),G.arc(P.x,P.y,T,0,r,!0),G.moveTo(q.x+T,q.y),G.arc(q.x,q.y,T,0,r,!0),J+=3}}if(G.fill(),G.stroke(),G.beginPath(),J=0,G.strokeStyle=Y,G.lineWidth=2,(B===H||A===H)&&N.$9l!=w){var n=c[N.$9l];G.moveTo(n.x+T,n.y),G.arc(n.x,n.y,T,0,r,!0),G.stroke()}}}}),P){N.$6l=z(P),d(P,p.getEditRectPadding()/b);var bl={x:P.x+P.width/2,y:P.y+P.height/2},Ol=od(bl,P.width,P.height,f),qo=Ol[0],Yh=Ol[1],$o=Ol[2],El=Ol[3],gs=Ol[4],Nh=Ol[5],Un=Ol[6],Fe=Ol[7];if(qo=Vk(Ol[0],b),Yh=Vk(Ol[1],b),$o=Vk(Ol[2],b),El=Vk(Ol[3],b),gs=Vk(Ol[4],b),Nh=Vk(Ol[5],b),Un=Vk(Ol[6],b),Fe=Vk(Ol[7],b),N.$8l=P,t>0&&(N.$16l=[qo,gs,Yh,Nh,El,Un,$o,Fe],G.beginPath(),G.lineWidth=1,G.strokeStyle=y,"dashed"===k&&G.setLineDash&&G.setLineDash(v),G.moveTo(qo.x,qo.y),G.lineTo(Yh.x,Yh.y),G.lineTo(El.x,El.y),G.lineTo($o.x,$o.y),G.lineTo(qo.x,qo.y),G.stroke(),"dashed"===k&&G.setLineDash&&G.setLineDash([])),G.beginPath(),G.lineWidth=1,G.fillStyle=L,G.strokeStyle=V,t>0){var vh=Nh.x-Fe.x,On=Nh.y-Fe.y,Pc=e(vh*vh+On*On),Gd=gs.x-Un.x,ql=gs.y-Un.y,im=e(Gd*Gd+ql*ql),km=2*c;if(p.isDirectionEditable&&1===dj.length){var Qh=dj[0],zi=p.getDataUI(Qh),Qf=zi._55O,Yq=p.isDirectionEditable.bind(p);if(Qf._42O){var Ze,ai,zd,Cm;Yq(Qh,"northwest")&&(Ze=!0,G.rect(qo.x-T,qo.y-T,c,c)),Yq(Qh,"northeast")&&(ai=!0,G.rect(Yh.x-T,Yh.y-T,c,c)),Yq(Qh,"southwest")&&(zd=!0,G.rect($o.x-T,$o.y-T,c,c)),Yq(Qh,"southeast")&&(Cm=!0,G.rect(El.x-T,El.y-T,c,c)),Yq(Qh,"north")&&(Ze&&ai?Pc>km&&G.rect(gs.x-T,gs.y-T,c,c):G.rect(gs.x-T,gs.y-T,c,c)),Yq(Qh,"south")&&(Cm&&zd?Pc>km&&G.rect(Un.x-T,Un.y-T,c,c):G.rect(Un.x-T,Un.y-T,c,c)),Yq(Qh,"west")&&(zd&&Ze?im>km&&G.rect(Fe.x-T,Fe.y-T,c,c):G.rect(Fe.x-T,Fe.y-T,c,c)),Yq(Qh,"east")&&(Cm&&ai?im>km&&G.rect(Nh.x-T,Nh.y-T,c,c):G.rect(Nh.x-T,Nh.y-T,c,c))}}else Pc>km&&(G.rect(gs.x-T,gs.y-T,c,c),G.rect(Un.x-T,Un.y-T,c,c)),im>km&&(G.rect(Nh.x-T,Nh.y-T,c,c),G.rect(Fe.x-T,Fe.y-T,c,c)),G.rect(qo.x-T,qo.y-T,c,c),G.rect(Yh.x-T,Yh.y-T,c,c),G.rect($o.x-T,$o.y-T,c,c),G.rect(El.x-T,El.y-T,c,c)}if($>0){var ar=N.$23l=fg(gs,0,2*-c,f);G.moveTo(ar.x+T,ar.y),G.arc(ar.x,ar.y,T,0,r,!1)}G.fill(),G.stroke(),N.$40l&&N.$44l(G,P,f);var jb,Jr,xh=p.getLeftTopHelpers(),qp=p.getRightTopHelpers(),cr=p.getLeftBottomHelpers(),te=p.getRightBottomHelpers(),ld=p.getEdgeHelpers(),Gl=p.getEditHelperSize(),tq=Gl/2,Tf=function(w,o,Z,l){"leftTop"===o?(jb=P.x*b-Gl-T-("h"===l?Z*(Gl+T):0)-1,Jr=P.y*b-Gl-T-("v"===l?Z*(Gl+T):0)-1):"rightTop"===o?(jb=(P.x+P.width)*b+T+("h"===l?Z*(Gl+T):0)+1,Jr=P.y*b-Gl-T-("v"===l?Z*(Gl+T):0)-1):"leftBottom"===o?(jb=P.x*b-Gl-T-("h"===l?Z*(Gl+T):0)-1,Jr=(P.y+P.height)*b+T+("v"===l?Z*(Gl+T):0)+1):"rightBottom"===o&&(jb=(P.x+P.width)*b+T+("h"===l?Z*(Gl+T):0)+1,Jr=(P.y+P.height)*b+T+("v"===l?Z*(Gl+T):0)+1);var s=jb+tq,S=Jr+tq,k=(P.x+P.width/2)*b,B=(P.y+P.height/2)*b,X=fg({x:k,y:B},s-k,S-B,f);if("host"===w){if(I>0)return N.$77l(G,f,X),!0}else if("edge"===w){if(Q>0)return N.$80l(G,f,X),!0}else if("remove"===w){if(n>0)return dj&&1===dj.length&&dj[0]instanceof E?N.$81l(G,f,{x:k+Gl/2+5,y:B}):N.$81l(G,f,X),!0}else if("parent"===w){if(U>0)return dj&&1===dj.length&&dj[0]instanceof E?N.$76l(G,f,{x:k-Gl/2-5,y:B}):N.$76l(G,f,X),!0}else if("elevation"===w){if(fn>0)return N.$85l(G,f,X),!0}else if("tall"===w){if(Ee>0)return N.$86l(G,f,X),!0}else if("source"===w||"target"===w){var e=dj[0],v=p.getDataUI(e),A=er(v,!0),t=A[0],i=A[1];if(ph&&"source"===w)return N.$84l(G,P,t,!0,e.isLooped(),o,Z,l),!0;if(_j&&"target"===w)return N.$84l(G,P,i,!1,e.isLooped(),o,Z,l),!0}};if(xh&&xh.length>0){var mc=0;xh.forEach(function(e){Tf(e,"leftTop",mc,p.getLeftTopHelpersAlign()||"h")&&mc++})}if(qp&&qp.length>0){var mc=0;qp.forEach(function(k){Tf(k,"rightTop",mc,p.getRightTopHelpersAlign()||"h")&&mc++})}if(cr&&cr.length>0){var mc=0;cr.forEach(function(X){Tf(X,"leftBottom",mc,p.getLeftBottomHelpersAlign()||"h")&&mc++})}if(te&&te.length>0){var mc=0;te.forEach(function(R){Tf(R,"rightBottom",mc,p.getRightBottomHelpersAlign()||"h")&&mc++})}if(ld&&ld.length>0&&((ph||_j)&&dj&&1===dj.length&&dj[0]instanceof E?!0:!1)){var mc=0;ld.forEach(function(M){Tf(M,"edge",mc,"h")&&mc++})}if(N.$72l){var jk,Ic=N.$67l,fo=N.$68l,Ak=N.$69l,vm=(N.$71l,N.$70l),rb=N.$82l,bo=N.$83l;if(1===Ic?jk=fo:2===Ic?jk=Ak:3===Ic?jk=vm:5===Ic?jk=rb:6===Ic&&(jk=bo),jk){var gf=p.lp(N.$72l),jm=p.getDataAt(N.$72l);if(jm&&jm instanceof C){var Ve,cf,Uc;if(N.$73l=jm,1===Ic)if(jm instanceof S.Grid)Ve=N.$75l=Xj(jm,gf);else if(jm instanceof S.Shape){Uc=N.$74l=fl(jm,gf);var dh=jm.getPoints();if(Uc){var Eq=Uc.attachIndex,Qd=ah(jm,p.getDataUI(jm),Eq)+1,ng=Qd+1>=dh.size()?0:Qd+1,qc=dh.get(Qd),Nd=dh.get(ng),Gr=jm.p(),Xb=jm.getRotation();qc=fg(Gr,qc.x-Gr.x,qc.y-Gr.y,Xb),Nd=fg(Gr,Nd.x-Gr.x,Nd.y-Gr.y,Xb),G.beginPath(),G.strokeStyle=s,G.lineWidth=W,G.moveTo(qc.x*b,qc.y*b),G.lineTo(Nd.x*b,Nd.y*b),G.stroke()}}Ve?cf=Ve.rect:(cf=J.clone(p.getDataUIBounds(jm)),J.grow(cf,2)),G.beginPath(),G.rect(cf.x*b,cf.y*b,cf.width*b,cf.height*b),G.strokeStyle=1===Ic||4===Ic||6===Ic?D:h,G.lineWidth=2,G.setLineDash&&G.setLineDash([8,8]),G.stroke()}else delete N.$73l;gf.x=gf.x*b,gf.y=gf.y*b;var Ao=Ib(jk.x,jk.y,gf.x,gf.y),Hk=fg(jk,gf.x-jk.x,gf.y-jk.y,-Ao),Eo=Hk.x-jk.x;G.translate(jk.x,jk.y),G.rotate(Ao),q.width=Eo,q.height=40;var gc=h;(1===Ic||4===Ic||6===Ic)&&(gc=D),q.comps[0].gradientColor=gc,J.drawImage(G,q,0,-20,Eo,40)}}}if(N.$87l&&p.sm().contains(N.$87l)){var mh,ll=N.$87l,Co=N.$88l,Gl=p.getEditHelperSize(),tq=Gl/2;if(p.isHelperEditable(ll,"pointElevation"))if(ll instanceof O){var Op=ll.getPosition();mh=J.clone(ll.getPoints().get(Co)),mh=fg({x:Op.x,y:Op.y},mh.x-Op.x,mh.y-Op.y,ll.getRotation()),mh.x*=b,mh.y*=b,G.translate(mh.x,mh.y),J.drawImage(G,id,tq,-tq,Gl,Gl),G.translate(-mh.x,-mh.y),N._pointElevationHelperPoint={x:mh.x+Gl,y:mh.y}}else if(ll instanceof E){var ie=Gf(p.getDataUI(ll),ll.s("edge.points")),mh=J.clone(ie.get(Co));mh.x*=b,mh.y*=b,G.translate(mh.x,mh.y),J.drawImage(G,id,tq,-tq,Gl,Gl),G.translate(-mh.x,-mh.y),N._pointElevationHelperPoint={x:mh.x+Gl,y:mh.y}}}G.restore(),N.$5l=0}},$89l:function(o,D,I,K){o.save();var f=this,W=f.gv,U=W.getEditHelperSize(),b=U/2;o.beginPath(),o.translate(I.x,I.y),o.rotate(D),J.drawImage(o,K,-b,-b,U,U),o.restore()},$85l:function(H,z,N){var F=this;F.$90l=N,F.$89l(H,z,N,id)},$86l:function(v,f,p){var x=this;x.$91l=p,x.$89l(v,f,p,wf)},$77l:function(x,v,e){var A=this;A.$68l=e,A.$89l(x,v,e,k)},$80l:function(Z,z,v){var x=this;x.$70l=v,x.$89l(Z,z,v,$)},$81l:function(w,y,I){var A=this;A.$71l=I,A.$89l(w,y,I,He)},$76l:function(g,r,D){var n=this;n.$69l=D,n.$89l(g,r,D,X)},$84l:function(q,j,k,I,N){var n,C=this,g=C.gv,u=g.getZoom(),V=g.getEditHelperSize(),i=V/2;k.x*=u,k.y*=u,N&&(I?k.x-=i+5:k.x+=i+5),k.y-=V-2,I?(C.$82l=k,n=Lc):(C.$83l=k,n=Oi),q.beginPath(),q.translate(k.x,k.y),J.drawImage(q,n,-i,-i,V,V),q.translate(-k.x,-k.y)},$44l:function(d,U,Y){d.save();var R=this.gv.getZoom(),Z=e(o(U.width,2)+o(U.height,2))/2*R+10,S=Z,P=S+8,E=S+18,O=Y,n=U.x+U.width/2,$=U.y+U.height/2;d.translate(n*R,$*R),d.beginPath(),d.strokeStyle="rgb(150, 150, 150)";for(var _=0,u=0,T=0,G=0,w=0,h=0;360>h;h++)_=h*N/180,0===h%5&&(u=A(_)*S,T=L(_)*S,G=A(_)*P,w=L(_)*P,d.moveTo(u,T),d.lineTo(G,w)),0===h%45&&(u=A(_)*S,T=L(_)*S,G=A(_)*E,w=L(_)*E,d.moveTo(u,T),d.lineTo(G,w));d.stroke(),d.beginPath(),d.rotate(-W),d.beginPath(),d.fillStyle="rgba(255, 0, 0, 0.1)",d.strokeStyle="rgb(157, 157, 157)",d.moveTo(0,0),d.arc(0,0,E,0,Y,!1),d.fill(),d.beginPath(),d.moveTo(0+E,0),d.arc(0,0,E,0,Y,!1),d.stroke(),d.rotate(W),d.font="bold 12px Verdana, Arial";var I=20*L(O),s=20*A(O),c=f(180*O/N)+"";d.textAlign="center",d.textBaseline="middle",d.beginPath();var k=d.measureText("365.").width;d.fillStyle="white",d.rect(I-k/2,-s-10,k,20),d.fill(),d.beginPath(),d.fillStyle="rgb(79,79,79)",d.fillText(c,I,-s),d.restore()}})}(this,Object);